<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nourish & Flourish Dark Mode</title>
<style>
  body {
    margin: 0;
    font-family: 'Roboto', 'Segoe UI', sans-serif;
    background: #121212;
    display: flex;
    justify-content: center;
    color: #fff;
  }
  .game-container {
    width: 360px;
    height: 640px;
    background: #1e1e2f;
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    padding: 15px;
    box-sizing: border-box;
    box-shadow: 0 4px 15px rgba(0,0,0,0.6);
    position: relative;
  }
  .top-bar { display: flex; justify-content: space-between; font-size: 16px; font-weight: 500; margin-bottom: 12px; }
  .metric { display: flex; align-items: center; gap: 5px; }
  .current-meal { text-align: center; font-size: 20px; font-weight: 600; margin-top: 10px; margin-bottom: 15px; color: #ffcc00; }
  .meter-container { margin-bottom: 12px; }
  .meter-label { font-size: 13px; margin-bottom: 3px; color: #ccc; display: flex; align-items: center; gap:5px; }
  .meter { width: 100%; height: 18px; background: #333; border-radius: 8px; overflow: hidden; position: relative; }
  .meter-fill { height: 100%; width: 50%; transition: width 0.3s, background-color 0.3s; border-radius: 8px; position: absolute; left:0; top:0; }
  .meters-grid { display: flex; justify-content: space-between; margin-bottom: 15px; }
  .small-meter { width: 48%; }
  .meal-options { display: flex; flex-direction: column; gap: 10px; margin-bottom: 10px; }
  .meal-btn { padding: 12px; background: #2c2c3e; border: none; border-radius: 12px; font-size: 15px; cursor: pointer; display: flex; flex-direction: column; align-items: center; box-shadow: 0 2px 6px rgba(0,0,0,0.5); transition: 0.2s; color: #fff; }
  .meal-btn:hover { background: #3d3d55; transform: translateY(-2px); }
  .nutrients { font-size: 18px; display: flex; gap: 8px; justify-content: center; margin-top: 5px; color: #bbb; }
  .cost { font-weight: bold; color: #ffd700; margin-top: 5px; }
  .meal-title { font-weight: bold; margin-bottom: 5px; color: #ffcc00; font-size: 14px; }
  .modal { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.85); display: flex; justify-content: center; align-items: center; border-radius: 16px; flex-direction: column; color: #fff; font-size: 18px; text-align: center; padding: 20px; display: none; }
  .modal h2 { font-size: 24px; margin-bottom: 15px; color: #ff5555; }
  .modal button { margin-top: 20px; padding: 10px 20px; background: #ffcc00; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; }
</style>
</head>
<body>

<div class="game-container">
  <div class="top-bar">
    <div class="metric">‚öñÔ∏è 70kg</div>
    <div class="metric" id="money-display">üí∞ $200</div>
  </div>

  <div class="meter-container">
    <div class="meter-label">üçΩÔ∏è Fullness</div>
    <div class="meter"><div class="meter-fill" id="fullness-fill"></div></div>
  </div>

  <div class="meter-container">
    <div class="meter-label">üòã Pleasure</div>
    <div class="meter"><div class="meter-fill" id="pleasure-fill"></div></div>
  </div>

  <div class="meters-grid">
    <div class="small-meter">
      <div class="meter-label">ü•ñ Carbs</div>
      <div class="meter"><div class="meter-fill" id="carbs-fill"></div></div>
    </div>
    <div class="small-meter">
      <div class="meter-label">üçó Protein</div>
      <div class="meter"><div class="meter-fill" id="protein-fill"></div></div>
    </div>
  </div>

  <div class="meters-grid">
    <div class="small-meter">
      <div class="meter-label">üßà Fat</div>
      <div class="meter"><div class="meter-fill" id="fat-fill"></div></div>
    </div>
    <div class="small-meter">
      <div class="meter-label">ü•¶ Vitamins</div>
      <div class="meter"><div class="meter-fill" id="vit-fill"></div></div>
    </div>
  </div>

  <div class="current-meal" id="current-meal">Day 1 - Breakfast</div>
  <div class="meal-options" id="meal-options"></div>

  <div class="modal" id="game-over-modal">
    <h2 id="game-over-msg">Game Over!</h2>
    <button onclick="restartGame()">Restart</button>
  </div>
</div>

<script>
const foodCatalog = [
  {name:"Oatmeal", effects:{carbs:10, protein:3, fat:1, vit:5, fullness:15, pleasure:-10}, nutrients:["carbs","protein","fat","vit"], cost:11},
  {name:"Burger", effects:{carbs:15, protein:8, fat:7, vit:2, fullness:20, pleasure:10}, nutrients:["carbs","protein","fat","vit"], cost:15},
  {name:"Salad", effects:{carbs:5, protein:-2, fat:0, vit:15, fullness:10, pleasure:-15}, nutrients:["carbs","protein","fat","vit"], cost:10},
  {name:"Pizza", effects:{carbs:20, protein:5, fat:9, vit:1, fullness:25, pleasure:12}, nutrients:["carbs","protein","fat","vit"], cost:17},
  {name:"Grilled Chicken", effects:{protein:18, fat:3, vit:8, fullness:18, pleasure:5}, nutrients:["protein","fat","vit"], cost:18},
  {name:"Fries", effects:{carbs:15, protein:-5, fat:5, vit:-2, fullness:15, pleasure:10}, nutrients:["carbs","protein","fat","vit"], cost:9},
  {name:"Apple", effects:{carbs:8, protein:-1, vit:8, fullness:3, pleasure:-10}, nutrients:["carbs","protein","vit"], cost:8},
  {name:"Banana", effects:{carbs:10, protein:-1, vit:8, fullness:2, pleasure:-10}, nutrients:["carbs","protein","vit"], cost:8},
  {name:"Yogurt", effects:{carbs:5, protein:8, fat:1, fullness:4, pleasure:3}, nutrients:["carbs","protein","fat"], cost:9},
  {name:"Candy Bar", effects:{carbs:12, protein:-3, fat:3, vit:-3, fullness:5, pleasure:15}, nutrients:["carbs","protein","fat","vit"], cost:7},
  {name:"Soft Drink", effects:{carbs:15, protein:-2, fat:0, vit:-2, fullness:2, pleasure:10}, nutrients:["carbs","protein","vit"], cost:6}
];

let fullness = 50, pleasure = 50, carbs = 50, protein = 50, fat = 25, vit = 50, money = 200;
let day = 1, mealsEaten = 0;
const mealTitles = ["Breakfast","Lunch","Dinner"];

function updateMeters() {
  function meterColor(value, type) {
    if (type === 'fullness' || type === 'pleasure' || type === 'protein' || type === 'vit') {
      if (value < 35) return '#f44336';
      if (value < 70) return '#ff9800';
      return '#4caf50';
    } else if (type === 'fat') {
      if (value >= 100) return '#f44336';
      if (value > 40) return '#ff9800';
      return '#4caf50';
    } else if (type === 'carbs') {
      return value <= 80 ? '#4caf50' : '#f44336';
    }
    return '#7c4dff';
  }
  document.getElementById('fullness-fill').style.width = fullness + '%';
  document.getElementById('fullness-fill').style.backgroundColor = meterColor(fullness, 'fullness');
  document.getElementById('pleasure-fill').style.width = pleasure + '%';
  document.getElementById('pleasure-fill').style.backgroundColor = meterColor(pleasure, 'pleasure');
  document.getElementById('protein-fill').style.width = protein + '%';
  document.getElementById('protein-fill').style.backgroundColor = meterColor(protein, 'protein');
  document.getElementById('fat-fill').style.width = fat + '%';
  document.getElementById('fat-fill').style.backgroundColor = meterColor(fat, 'fat');
  document.getElementById('carbs-fill').style.width = carbs + '%';
  document.getElementById('carbs-fill').style.backgroundColor = meterColor(carbs, 'carbs');
  document.getElementById('vit-fill').style.width = vit + '%';
  document.getElementById('vit-fill').style.backgroundColor = meterColor(vit, 'vit');
  document.getElementById('money-display').textContent = `üí∞ $${money}`;
}

function clampValues() {
  fullness = Math.min(100, Math.max(0, fullness));
  pleasure = Math.min(100, Math.max(0, pleasure));
  carbs = Math.min(100, Math.max(0, carbs));
  protein = Math.min(100, Math.max(0, protein));
  fat = Math.min(100, Math.max(0, fat));
  vit = Math.min(100, Math.max(0, vit));
  money = Math.max(0, money);

  if(carbs >= 100) { carbs = 50; fat += 2; if(fat > 100) fat = 100; }
}

function checkGameOver() {
  let message = '';
  if (pleasure <= 0) message = "Your pleasure dropped to zero. You fell into depression!";
  else if (carbs <= 0) message = "You have starved of carbs. You developed fatigue!";
  else if (fullness <+ 0) message = "You starved to death! You didn't eat enough to survive.";
  else if (protein <= 0) message = "You have no protein left. You developed muscle wasting!";
  else if (fat <= 0 || fat >= 100) message = "Your fat level is critical. Game over!";
  else if (vit <= 0) message = "You have no vitamins left. You got scurvy!";
  else if (!foodCatalog.some(f => f.cost <= money)) message = "You cannot afford any more meals!";

  if (message) {
    document.getElementById('game-over-msg').textContent = "Game Over! " + message;
    document.getElementById('game-over-modal').style.display = 'flex';
    document.getElementById('meal-options').innerHTML = '';
    return true;
  }
  return false;
}

function getRandomMeals() {
  const options = [];
  const usedIndices = [];
  while (options.length < 3) {
    const idx = Math.floor(Math.random() * foodCatalog.length);
    if (!usedIndices.includes(idx)) {
      usedIndices.push(idx);
      options.push(foodCatalog[idx]);
    }
  }
  return options;
}

function renderMeals() {
  if (checkGameOver()) return;
  const mealsDiv = document.getElementById('meal-options');
  mealsDiv.innerHTML = '';
  const options = getRandomMeals();
  const mealTitle = mealTitles[mealsEaten % 3];
  document.getElementById('current-meal').textContent = `Day ${day} - ${mealTitle}`;

  options.forEach((food) => {
    const btn = document.createElement('button');
    btn.className = 'meal-btn';
    const icons = [];
    if(food.nutrients.includes("carbs")) icons.push('ü•ñ');
    if(food.nutrients.includes("protein")) icons.push('üçó');
    if(food.nutrients.includes("fat")) icons.push('üßà');
    if(food.nutrients.includes("vit")) icons.push('ü•¶');

    btn.innerHTML = `${food.name} <span class="cost">$${food.cost}</span>
      <div class="nutrients">${icons.join(' ')}</div>`;
    btn.onclick = () => eatMeal(food);
    mealsDiv.appendChild(btn);
  });
}

function eatMeal(food) {
  if (money >= food.cost) {
    // Apply nutrients
    food.nutrients.forEach(n => {
      switch(n) {
        case 'carbs': carbs += food.effects.carbs; break;
        case 'protein': protein += food.effects.protein; break;
        case 'fat': fat += food.effects.fat; break;
        case 'vit': vit += food.effects.vit; break;
      }
    });
    // Apply meal fullness first, then decrease by 70
    fullness += food.effects.fullness;
    fullness -= 12;

    pleasure += food.effects.pleasure;
    money -= food.cost;

    mealsEaten++;
    if (mealsEaten % 3 === 0) {
      day++;
      if (day % 8 === 0) money += 150;
    }

    clampValues();
    updateMeters();
    renderMeals();
  } else alert("Not enough money!");
}

function restartGame() {
  fullness = 50; pleasure = 50; carbs = 50; protein = 50; fat = 25; vit = 50; money = 200;
  day = 1; mealsEaten = 0;
  document.getElementById('game-over-modal').style.display = 'none';
  updateMeters();
  renderMeals();
}

renderMeals();
updateMeters();
</script>
</body>
</html>

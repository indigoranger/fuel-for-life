<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fuel for Life</title>
<style>
  body {
    margin: 0;
    font-family: 'Roboto', 'Segoe UI', sans-serif;
    background: #1e1e2f;
    height: 80vh;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #fff;
  }
  .game-container {
    width: 100%;
    max-width: 360px;
    height: 100%;
    max-height: 640px;
    background: #1e1e2f;
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    padding: 15px;
    box-sizing: border-box;
    position: relative;
  }
  .top-bar { display: flex; justify-content: space-between; font-size: 16px; font-weight: 500; margin-bottom: 12px; }
  .metric { display: flex; align-items: center; gap: 5px; }
  .current-meal { text-align: center; font-size: 20px; font-weight: 600; margin-top: 10px; margin-bottom: 15px; color: #ffcc00; }
  .meter-container { margin-bottom: 12px; }
  .meter-label { font-size: 13px; margin-bottom: 3px; color: #ccc; display: flex; align-items: center; gap:5px; }
  .meter { width: 100%; height: 18px; background: #333; border-radius: 8px; overflow: hidden; position: relative; }
  .meter-fill { height: 100%; width: 50%; transition: width 0.3s, background-color 0.3s; border-radius: 8px; position: absolute; left:0; top:0; }
  .meters-grid { display: flex; justify-content: space-between; margin-bottom: 15px; }
  .small-meter { width: 48%; }
  .meal-options { display: flex; flex-direction: column; gap: 10px; margin-bottom: 10px; }
  
  /* Updated meal button styling */
  .meal-btn {
    padding: 12px;
    background: #2c2c3e;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.5);
    transition: 0.2s;
    color: #fff;
    text-align: center;
  }
  .meal-btn:hover { background: #3d3d55; transform: translateY(-2px); }
  .meal-emoji {
    font-size: 36px;
    margin-bottom: 5px;
  }
  .meal-title {
    font-weight: bold;
    margin-bottom: 5px;
    color: #ffcc00;
    font-size: 16px;
  }
  .nutrients {
    font-size: 18px;
    display: flex;
    gap: 8px;
    justify-content: center;
    margin-top: 5px;
    color: #bbb;
  }
  .modal { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.85); display: flex; justify-content: center; align-items: center; border-radius: 16px; flex-direction: column; color: #fff; font-size: 18px; text-align: center; padding: 20px; display: none; }
  .modal h2 { font-size: 24px; margin-bottom: 15px; color: #ff5555; }
  .modal button { margin-top: 20px; padding: 10px 20px; background: #ffcc00; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; }
  .splash-screen {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: #1e1e2f;
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 20px;
    z-index: 10;
    color: #fff;
    font-size: 18px;
    text-align: center;
    padding: 20px;
  }
  .splash-screen h1 { font-size: 32px; color: #ffcc00; margin-bottom: 10px; }
  .splash-screen button { padding: 12px 24px; font-size: 18px; border-radius: 12px; border: none; background: #ffcc00; color: #1e1e2f; font-weight: bold; cursor: pointer; transition: 0.2s; }
  .splash-screen button:hover { background: #ffd633; }
  .splash-screen a { color: #ffd633; text-decoration: underline; cursor: pointer; font-size: 16px; }
  .instructions-screen {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: #1e1e2f;
    border-radius: 16px;
    z-index: 11;
    color: #fff;
    display: flex;
    flex-direction: column;
    padding: 20px;
    box-sizing: border-box;
    overflow-y: auto;
    font-size: 14px;
  }
  .instructions-screen h2 { font-size: 26px; color: #ffcc00; margin-bottom: 10px; text-align: center; }
  .instructions-screen h3 { font-size: 18px; color: #ffd633; margin-top: 15px; margin-bottom: 5px; }
  .instructions-screen p { margin-bottom: 12px; line-height: 1.6; color: #ccc; }
  .instructions-screen ul { margin-left: 15px; line-height: 1.6; margin-bottom: 12px; }
  .instructions-screen li { margin-bottom: 6px; }
  .instructions-screen .back-btn {
    position: sticky;
    bottom: 10px;
    background: #ffcc00;
    color: #1e1e2f;
    border: none;
    border-radius: 10px;
    padding: 10px 20px;
    font-weight: bold;
    cursor: pointer;
    align-self: center;
    margin-top: 15px;
  }
  .instructions-screen .back-btn:hover { background: #ffd633; }
  .instructions-screen::-webkit-scrollbar { width: 8px; }
  .instructions-screen::-webkit-scrollbar-track { background: #1e1e2f; border-radius: 4px; }
  .instructions-screen::-webkit-scrollbar-thumb { background: #ffd633; border-radius: 4px; }
  .instructions-screen::-webkit-scrollbar-thumb:hover { background: #ffcc00; }
</style>
</head>
<body>

<div class="game-container">
  <audio id="meal-sound" src="meal.mp3"></audio>
  <audio id="happy-sound" src="happychoice.mp3"></audio>
  <audio id="sad-sound" src="sadchoice.mp3"></audio>

  <div class="splash-screen" id="splash-screen">
    <h1>Fuel for Life</h1>
    <p>Balance your nutrients, keep your body healthy, and survive as long as you can!</p>
    <button onclick="startGame()">Start Game</button>
    <a onclick="showInstructions()">Instructions</a>
  </div>

  <div class="instructions-screen" id="instructions-screen" style="display:none;">
    <h2>Fuel for Life - Instructions</h2>
    <p>Welcome! Your goal is to maintain a healthy balance of nutrients, manage your money, and enjoy your meals. Make strategic choices to survive as long as possible.</p>
    <h3>Basic Rules</h3>
    <ul>
      <li>Eat three meals per day: Breakfast, Lunch, Dinner.</li>
      <li>Each meal has a cost. If you cannot afford any meal, the game ends.</li>
      <li>Meals affect Carbs, Protein, Fat, Vitamins, Fullness, and Pleasure.</li>
      <li>Fullness and Pleasure need to stay in healthy ranges to avoid penalties.</li>
    </ul>
    <h3>Nutrition Guide</h3>
    <ul>
      <li>Carbs provide energy but excessive carbs increase fat.</li>
      <li>Protein builds muscle and helps recovery.</li>
      <li>Fat impacts weight. Too little or too much is unhealthy.</li>
      <li>Vitamins improve overall health and well-being.</li>
      <li>Pleasure influences happiness. Low pleasure reduces satisfaction.</li>
    </ul>
    <h3>Gameplay Tips</h3>
    <ul>
      <li>Balance nutrients; do not focus only on one.</li>
      <li>Track money to ensure you can buy food daily.</li>
      <li>Use high-protein meals to counteract low protein levels.</li>
      <li>Combine foods to maintain fullness without overspending.</li>
      <li>Keep an eye on fat levels; weight changes with fat.</li>
    </ul>
    <h3>Hints & Strategy</h3>
    <ul>
      <li>Rotate meals to prevent nutrient depletion.</li>
      <li>High pleasure foods improve satisfaction but may unbalance fullness.</li>
      <li>Plan purchases to avoid running out of money mid-day.</li>
      <li>Monitor all meters; falling too low in any can end the game faster.</li>
    </ul>
    <button class="back-btn" onclick="backToSplash()">Back</button>
  </div>

  <div class="top-bar">
    <div class="metric" id="weight-display">‚öñüßçüèª‚Äç‚ôÇÔ∏è 70kg</div>
    <div class="metric" id="money-display">üí∞ $200</div>
  </div>

  <div class="meter-container">
    <div class="meter-label">üçΩÔ∏è Fullness</div>
    <div class="meter"><div class="meter-fill" id="fullness-fill"></div></div>
  </div>

  <div class="meter-container">
    <div class="meter-label">üòã Pleasure</div>
    <div class="meter"><div class="meter-fill" id="pleasure-fill"></div></div>
  </div>

  <div class="meters-grid">
    <div class="small-meter">
      <div class="meter-label">ü•ñ Carbs</div>
      <div class="meter"><div class="meter-fill" id="carbs-fill"></div></div>
    </div>
    <div class="small-meter">
      <div class="meter-label">üçó Protein</div>
      <div class="meter"><div class="meter-fill" id="protein-fill"></div></div>
    </div>
  </div>

  <div class="meters-grid">
    <div class="small-meter">
      <div class="meter-label">üßà Fat</div>
      <div class="meter"><div class="meter-fill" id="fat-fill"></div></div>
    </div>
    <div class="small-meter">
      <div class="meter-label">ü•¶ Vitamins</div>
      <div class="meter"><div class="meter-fill" id="vit-fill"></div></div>
    </div>
  </div>

  <div class="current-meal" id="current-meal">Day 1 - Breakfast</div>
  <div class="meal-options" id="meal-options"></div>

  <div class="modal" id="game-over-modal">
    <h2 id="game-over-msg">Game Over!</h2>
    <button onclick="restartGame()">Restart</button>
  </div>
</div>

<script>
const foodCatalog = [
  {name:"Oatmeal", emoji:"ü•£", effects:{carbs:10, protein:2, fat:1, vit:2, fullness:15, pleasure:-10}, nutrients:["carbs","protein","vit"], cost:10},
  {name:"Burger", emoji:"üçî", effects:{carbs:15, protein:5, fat:7, vit:2, fullness:20, pleasure:10}, nutrients:["carbs","protein","fat"], cost:15},
  {name:"Salad", emoji:"ü•ó", effects:{carbs:5, protein:-15, fat:-7, vit:4, fullness:17, pleasure:-15}, nutrients:["carbs","vit"], cost:8},
  {name:"Pizza", emoji:"üçï", effects:{carbs:20, protein:1, fat:9, vit:1, fullness:25, pleasure:12}, nutrients:["carbs","protein","fat"], cost:17},
  {name:"Grilled Chicken", emoji:"üçó", effects:{protein:8, fat:3, vit:2, fullness:18, pleasure:5}, nutrients:["protein","fat"], cost:12},
  {name:"Fries", emoji:"üçü", effects:{carbs:15, protein:-10, fat:5, vit:-2, fullness:15, pleasure:10}, nutrients:["carbs","fat"], cost:7},
  {name:"Apple", emoji:"üçé", effects:{carbs:8, protein:-6, fat:-5, vit:4, fullness:3, pleasure:-10}, nutrients:["carbs","vit"], cost:3},
  {name:"Banana", emoji:"üçå", effects:{carbs:10, protein:-7, fat:-4, vit:4, fullness:2, pleasure:-10}, nutrients:["carbs","vit"], cost:2},
  {name:"Yogurt", emoji:"ü•õ", effects:{carbs:5, protein:4, fat:1, fullness:4, pleasure:3}, nutrients:["carbs","protein"], cost:4},
  {name:"Candy Bar", emoji:"üç´", effects:{carbs:12, protein:-7, fat:3, vit:-3, fullness:5, pleasure:15}, nutrients:["carbs", "fat"], cost:3},
  {name:"Soft Drink", emoji:"ü•§", effects:{carbs:15, protein:-7, fat:0, vit:-2, fullness:2, pleasure:10}, nutrients:["carbs"], cost:3}
];

let fullness = 50, pleasure = 50, carbs = 50, protein = 50, fat = 25, vit = 50, money = 230;
let day = 1, mealsEaten = 0;
let consecutiveFullnessMax = 0;
const mealTitles = ["Breakfast","Lunch","Dinner"];

const mealSound = document.getElementById('meal-sound');
const happySound = document.getElementById('happy-sound');
const sadSound = document.getElementById('sad-sound');

function startGame() {
  document.getElementById('splash-screen').style.display = 'none';
  document.getElementById('instructions-screen').style.display = 'none';
  updateMeters();
  renderMeals();
}

function showInstructions() {
  document.getElementById('splash-screen').style.display = 'none';
  document.getElementById('instructions-screen').style.display = 'flex';
}

function backToSplash() {
  document.getElementById('instructions-screen').style.display = 'none';
  document.getElementById('splash-screen').style.display = 'flex';
}

function updateWeight() {
  const weight = 40 + (fat / 100) * (110 - 40);
  document.getElementById('weight-display').textContent = `‚öñÔ∏è ${Math.round(weight)}kg`;
}

function updateMeters() {
  function meterColor(value, type) {
    if (type === 'fullness' || type === 'pleasure' || type === 'protein' || type === 'vit') {
      if (value < 35) return '#f44336';
      if (value < 70) return '#ff9800';
      return '#4caf50';
    } else if (type === 'fat') {
      if (value >= 100) return '#f44336';
      if (value > 40) return '#ff9800';
      return '#4caf50';
    } else if (type === 'carbs') {
      return value <= 80 ? '#4caf50' : '#f44336';
    }
    return '#7c4dff';
  }

  document.getElementById('fullness-fill').style.width = fullness + '%';
  document.getElementById('fullness-fill').style.backgroundColor = meterColor(fullness, 'fullness');
  document.getElementById('pleasure-fill').style.width = pleasure + '%';
  document.getElementById('pleasure-fill').style.backgroundColor = meterColor(pleasure, 'pleasure');
  document.getElementById('protein-fill').style.width = protein + '%';
  document.getElementById('protein-fill').style.backgroundColor = meterColor(protein, 'protein');
  document.getElementById('fat-fill').style.width = fat + '%';
  document.getElementById('fat-fill').style.backgroundColor = meterColor(fat, 'fat');
  document.getElementById('carbs-fill').style.width = carbs + '%';
  document.getElementById('carbs-fill').style.backgroundColor = meterColor(carbs, 'carbs');
  document.getElementById('vit-fill').style.width = vit + '%';
  document.getElementById('vit-fill').style.backgroundColor = meterColor(vit, 'vit');
  document.getElementById('money-display').textContent = `üí∞ $${money}`;
  updateWeight();
}

function getRandomMeals() {
  const options = [];
  const usedIndices = [];
  while (options.length < 3) {
    const idx = Math.floor(Math.random() * foodCatalog.length);
    if (!usedIndices.includes(idx)) {
      usedIndices.push(idx);
      options.push(foodCatalog[idx]);
    }
  }
  return options;
}

function renderMeals() {
  mealSound.play(); // play meal sound
  const mealsDiv = document.getElementById('meal-options');
  mealsDiv.innerHTML = '';
  const options = getRandomMeals();
  const mealTitle = mealTitles[mealsEaten % 3];
  document.getElementById('current-meal').textContent = `Day ${day} - ${mealTitle}`;

  let affordable = false;

  options.forEach(food => {
    const btn = document.createElement('button');
    btn.className = 'meal-btn';

    const mainEmoji = food.emoji;

    const nutrientIcons = [];
    if(food.nutrients.includes("carbs")) nutrientIcons.push('ü•ñ');
    if(food.nutrients.includes("protein")) nutrientIcons.push('üçó');
    if(food.nutrients.includes("fat")) nutrientIcons.push('üßà');
    if(food.nutrients.includes("vit")) nutrientIcons.push('ü•¶');

    btn.innerHTML = `<div class="meal-emoji">${mainEmoji}</div>
                     <div class="meal-title">${food.name} <span class="cost">$${food.cost}</span></div>
                     <div class="nutrients">${nutrientIcons.join(' ')}</div>`;

    if(money >= food.cost) {
      affordable = true;
      btn.onclick = () => eatMeal(food);
    } else {
      btn.disabled = true;
      btn.style.opacity = 0.5;
    }

    mealsDiv.appendChild(btn);
  });

  if(!affordable) showGameOver("You can't afford any meals!");
}

function eatMeal(food) {
  const old = {fullness, pleasure, carbs, protein, vit};

  food.nutrients.forEach(n => {
    switch(n) {
      case 'carbs': carbs += food.effects.carbs; break;
      case 'protein': protein += food.effects.protein; break;
      case 'fat': fat += food.effects.fat; break;
      case 'vit': vit += food.effects.vit; break;
    }
  });
  fullness += food.effects.fullness - 12;
  pleasure += food.effects.pleasure;
  money -= food.cost;

  mealsEaten++;
  if(mealsEaten % 3 === 0) day++;

  if(mealsEaten % 21 === 0) {
    money += 150;
    alert("You received your weekly allowance of $150!");
  }

  if(fullness >= 100) consecutiveFullnessMax++;
  else consecutiveFullnessMax = 0;

  clampValues();
  playChoiceSound(old);
  checkGameOver();
  updateMeters();
  renderMeals();
}

function playChoiceSound(old) {
  const majorityDown = (
    (fullness < old.fullness ? 1 : 0) +
    (pleasure < old.pleasure ? 1 : 0) +
    (protein < old.protein ? 1 : 0) +
    (vit < old.vit ? 1 : 0) +
    (carbs > old.carbs ? 1 : 0)
  ) >= 3;

  if(majorityDown) sadSound.play();
  else happySound.play();
}

function clampValues() {
  if(carbs > 100) {
    carbs = 50;
    fat = Math.min(100, fat + 4);
    alert("Your body converted excess carbs to fat.");
  }

  fullness = Math.min(100, Math.max(0, fullness));
  pleasure = Math.min(100, Math.max(0, pleasure));
  carbs = Math.min(100, Math.max(0, carbs));
  protein = Math.min(100, Math.max(0, protein));
  fat = Math.min(100, Math.max(0, fat));
  vit = Math.min(100, Math.max(0, vit));
  money = Math.max(0, money);
}

function checkGameOver() {
  if(fullness === 0) return showGameOver("You starved from lack of food.");
  if(consecutiveFullnessMax >= 5) return showGameOver("You got food poisoning from overeating.");
  if(fullness === 100 && consecutiveFullnessMax < 5) return showGameOver("You overate and collapsed.");
  if(pleasure === 0) return showGameOver("Life lost its meaning‚Ä¶ you lost motivation to continue.");
  if(fat === 100) return showGameOver("Your health collapsed due to obesity.");
  if(protein === 0) return showGameOver("Your body broke down from protein deficiency.");
  if(vit === 0) return showGameOver("You got sick from vitamin deficiency.");
  const affordable = foodCatalog.some(f => f.cost <= money);
  if(!affordable) return showGameOver("You can't afford any meals!");
}

function showGameOver(msg) {
  document.getElementById('game-over-msg').textContent = msg;
  document.getElementById('game-over-modal').style.display = 'flex';
}

function restartGame() {
  fullness = 50; pleasure = 50; carbs = 50; protein = 50; fat = 25; vit = 50; money = 200;
  day = 1; mealsEaten = 0; consecutiveFullnessMax = 0;
  document.getElementById('game-over-modal').style.display = 'none';
  updateMeters();
  renderMeals();
}
</script>
</body>
</html>
